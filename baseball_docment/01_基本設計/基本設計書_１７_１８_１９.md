# 第17章 移行設計17.1. データ移行要否不要 1本システムは新規構築であり、既存システムからのデータ移行は発生しない。17.2. 初期データ投入手順本番環境の構築完了後、アプリケーションを稼働させるために必要な初期データを投入する。データベースマイグレーションの実行:サーバーにデプロイ後、php artisan migrate コマンドを実行し、全テーブル（users, games, participations, device_tokens）を作成する。（第4章参照）初期データ（シーダー）の実行:オプションとして、「第4.7. マスタデータ投入SQL文」 2 に記載された初期管理者アカウントやテスト用試合データを投入する。以下のコマンドを実行する。Bash# (オプション) 初期データを投入する場合
php artisan db:seed
詳細設計への共通コンテキスト（第17章）後続タスク（詳細設計）への指示:シーダーファイルの作成:「第4.7. マスタデータ投入SQL文」 3 に基づき、初期管理者アカウントやテストデータを投入するための AdminUserSeeder.php や TestGameSeeder.php などのシーダークラスを database/seeders/ 配下に実装してください。DatabaseSeeder.php からこれらのシーダーを呼び出すよう設定してください。運用手順書への記載:「16. デプロイ設計」の初回デプロイ手順、または「運用手順書」に、php artisan migrate と php artisan db:seed（オプション）を実行する手順を明記してください。第18章 制約事項・前提条件18.1. インフラ制約ホスティング: インフラは Xserver VPS を利用することを前提とする。ミドルウェア: データベースは MySQL 8.0 4、Webサーバーは Nginx 5 を利用する。これ以外のミドルウェア（例: PostgreSQL, Apache）は利用しない。スケーラビリティ: 現時点では単一サーバー構成を前提とし、負荷増大時は Xserver VPS のプラン変更による垂直スケーリング（スケールアップ）を基本対応とする。18.2. 外部サービス制約プッシュ通知: Firebase Cloud Messaging (FCM) 6 を利用する。FCM の仕様変更（API、トークン管理など）に従う必要がある。メール送信: Xserver SMTP 7 を利用する。Xserver 側で定められた送信上限数（例: 1日の送信数制限）に従う必要がある。地図: Google Maps 8 を利用する。クライアント（Flutter）からディープリンク（URLスキーム）で起動することを前提とし、アプリ内へのSDK組み込みは行わない。18.3. 技術的制約技術スタックの固定:バックエンド: Laravel 10 9フロントエンド: Flutter認証: Laravel Sanctum 1010状態管理: Riverpod 2.x 1111上記の「技術選定の固定ルール」 1212 に記載された技術スタックを厳守し、これ以外の技術（例: Vue.js, React Native, JWT）の導入は原則禁止とする。リフレッシュトークン非採用:API認証トークンの有効期限は 24時間 1313とし、リフレッシュトークンは実装しない 1414。期限切れ時は必ず再ログイン（F-USR-002）を要求する。オフライン非対応:本システムは、APIサーバーと常時通信可能であることを前提とする。オフライン（圏外）時のデータ閲覧、参加登録、チェックイン機能はサポート対象外とする（非機能要件）。詳細設計への共通コンテキスト（第18章）後続タスク（詳細設計）への指示:設計への反映:以降の詳細設計（クラス設計、シーケンス図）は、本章に記載された全ての制約事項（Xserver VPS, MySQL 8.0, Laravel 10, Sanctum, Riverpod）を前提として作成してください。クライアント側実装:「オフライン非対応」の制約に基づき、Flutter側でインターネット接続が切れた場合（API通信失敗時）は、適切なエラーメッセージ（例: 「通信環境の良い場所で再度お試しください」）を表示し、ローカルにデータをキャッシュするなどの複雑なオフライン処理は実装しないでください。「リフレッシュトークン非採用」の制約に基づき、HTTP 401エラーを受信した際は、必ずログイン画面（SCR-USR-001）に遷移させる処理を実装してください（第7章参照）。第19章 用語集19.1. 技術用語用語説明LaravelPHP の Webアプリケーションフレームワーク。本システムのバックエンド（APIサーバー）で使用する 15。FlutterGoogle が開発したモバイルアプリケーションフレームワーク。本システムのクライアント（iOS/Androidアプリ）で使用する 16。SanctumLaravel の認証ライブラリ。本システムでは Personal Access Token (PAT) を使用したAPI認証に利用する 1717。RiverpodFlutter の状態管理ライブラリ。本システムのクライアント側状態管理で使用する（固定ルール）1818。Bcryptパスワードハッシュ化アルゴリズム。本システムのパスワード保存に利用する（固定ルール）19191919。FCMFirebase Cloud Messaging。プッシュ通知の配信に使用する外部サービス 20。Haversine formula球面上の2地点間の距離を計算する数式。チェックイン時の距離計算ロジックに採用する（固定ルール）21212121。PATPersonal Access Token。Sanctum が発行する認証トークン。CI/CD継続的インテグレーション / 継続的デリバリー。テストとデプロイを自動化する仕組み。19.2. ドメイン用語用語説明試合games テーブルで管理される、草野球の開催情報 22222222。参加者試合に参加登録したユーザー。参加登録F-USR-006。ユーザーが試合に参加（チームA/B、ポジション選択）すること 23232323。チェックインF-USR-008。参加者が試合当日に会場付近で、指定時間内に位置情報を送信し、来場を確定させる処理 242424242424242424。許容半径acceptable_radius。試合会場の緯度・経度から、チェックインを許可する半径（メートル単位）25252525。論理削除deleted_at カラムに日時を記録し、データはDB上に残したまま削除済みとして扱う方式 26262626。管理者F-ADM-XXX。ユーザー管理や試合管理、通知配信が可能な特権ユーザー。詳細設計への共通コンテキスト（第19章）後続タスク（詳細設計）への指示:用語の統一:以降に作成する全ドキュメント（詳細設計書、テスト仕様書、運用手順書など）およびコード内のコメントや変数名において、本用語集で定義された用語（特にドメイン用語）を統一して使用してください。例: 「参加」ではなく「参加登録」、「来場確認」ではなく「チェックイン」を使用する。